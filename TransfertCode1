Sub Etape2()

    Dim derniereL, derniereC, i As Integer
    Dim rng As Range
    Dim cell As Range
    Dim cellValue As Double
    Dim colWidths() As Double
    
    derniereL = Sheets("1Current").Cells(Rows.Count, 3).End(xlUp).Row
    derniereC = Sheets("1Current").Cells(3, Columns.Count).End(xlToLeft).Column
    
    For i = 3 To derniereC
        colWidths(i) = Sheets("1Current").Columns(i).ColumnWidth
    Next
    
    Call CopierCollerValeurs(Sheets("1Current"))
    
    Sheets("1Current").Range(Cells(3, 3), Cells(derniereL, derniereC)).Borders.LineStyle = xlNone
    
    Call CreerTableau(Sheets("1Current"))
    
    With Sheets("1Current").Range(Cells(3, 3), Cells(derniereL, derniereC)).Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = RGB(0, 0, 0)
        .Weight = xlMedium
    End With
    
    With Sheets("1Current").Range(Cells(3, 3), Cells(3, derniereC)).Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Color = RGB(255, 255, 255)
        .Weight = xlThin
    End With
    
    With Sheets("1Current").Range(Cells(3, 3), Cells(3, derniereC)).Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = RGB(255, 255, 255)
        .Weight = xlThin
    End With
    
    With Sheets("1Current").Range(Cells(3, 3), Cells(derniereL, derniereC)).Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = RGB(0, 0, 0)
        .Weight = xlMedium
    End With
        
    Sheets("1Current").Range(Cells(4, 8), Cells(derniereL, derniereC)).HorizontalAlignment = xlLeft
    
    Set rng = Sheets("1Current").Range(Cells(4, 8), Cells(derniereL, derniereC))
    
    For Each cell In rng
        If IsNumeric(cell.Value) Then
            cellValue = cell.Value
            
            If cellValue = Int(cellValue) Then
                cell.NumberFormat = "#,##0"
            Else
                cell.NumberFormat = "#,##0.00"
            End If
        End If
    Next
    
    For i = 3 To derniereC
        Sheets("1Current").Columns(i).ColumnWidth = colWidths(i)
    Next

    Sheets("1Current").Range(Cells(2, 1), Cells(2, derniereC)).ClearContents

End Sub
