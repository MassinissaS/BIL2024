Sub SauvegarderCopie()
    Dim cheminRepertoire As String
    Dim nomFichier As String
    Dim nouvelleCheminComplet As String

    ' Définir le répertoire de sauvegarde (modifiez ce chemin selon vos besoins)
    cheminRepertoire = "C:\Chemin\De\Votre\Répertoire\"
    
    ' Vérifier si le répertoire existe
    If Dir(cheminRepertoire, vbDirectory) = "" Then
        MsgBox "Le répertoire spécifié n'existe pas.", vbExclamation
        Exit Sub
    End If

    ' Générer un nom de fichier basé sur le nom actuel avec la date et l'heure
    nomFichier = ThisWorkbook.Name
    nouvelleCheminComplet = cheminRepertoire & _
                            Left(nomFichier, InStrRev(nomFichier, ".") - 1) & _
                            "_" & Format(Now, "yyyy-mm-dd_hhmmss") & ".xlsm"

    ' Sauvegarder une copie du fichier
    ThisWorkbook.SaveCopyAs nouvelleCheminComplet

    MsgBox "Le fichier a été sauvegardé avec succès dans " & nouvelleCheminComplet, vbInformation
End Sub
