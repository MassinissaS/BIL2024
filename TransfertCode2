Sub VerifierTrigger()

    Dim derLT, derLD, i, j, k, derC As Integer
    Dim champ, cond1, cond2, condition As String
    Dim signecond1, signecond2 As String
    Dim nbrcond1, nbrcond2 As Integer
    Dim firstLine As String
        
    derLT = Sheets("3Thresholds").Cells(Rows.Count, 3).End(xlUp).Row
    derLD = ActiveSheet.Cells(Rows.Count, 4).End(xlUp).Row
    derC = ActiveSheet.Cells(3, Columns.Count).End(xlToLeft).Column
    
    Call EnleverTrigger(Sheets("2Datas"))
        
    For i = 4 To derLT
        champ = Sheets("3Thresholds").Cells(i, 3).Value
        cond1 = Sheets("3Thresholds").Cells(i, 4).Value
        cond2 = Sheets("3Thresholds").Cells(i, 5).Value
        signecond1 = Left(cond1, 1)
        signecond2 = Left(cond2, 1)
        nbrcond1 = Left(Split(cond1, " ")(1), Len(Split(cond1, " ")(1)) - 1)
        
        If cond2 <> "" Then
        nbrcond2 = Left(Split(cond2, " ")(1), Len(Split(cond2, " ")(1)) - 1)
        Else
        nbrcond2 = Empty
        End If
        
        If InStr(ActiveSheet.Cells(3, j).Value, Chr(10)) > 0 Then
            firstLine = Left(ActiveSheet.Cells(3, j).Value, InStr(ActiveSheet.Cells(3, j).Value, Chr(10)) - 1)
        Else
            firstLine = ActiveSheet.Cells(3, j).Value
        End If
                    
        For j = 4 To derC
            If champ = firstLine Then
                For k = 4 To derLD
                    If IsEmpty(ActiveSheet.Cells(k, j).Value) = False And ActiveSheet.Cells(k, j).Value <> ".." Then
                        If signecond1 = "<" Then
                            If CDbl(ActiveSheet.Cells(k, j).Value) < nbrcond1 = True Then
                                ActiveSheet.Cells(k, j).Interior.ColorIndex = 22
                            End If
                        ElseIf signecond1 = ">" Then
                            If CDbl(ActiveSheet.Cells(k, j).Value) > nbrcond1 = True Then
                                ActiveSheet.Cells(k, j).Interior.ColorIndex = 22
                            End If
                        End If
                    End If
                Next
                If cond2 <> "" Then
                    For k = 4 To derLD
                        If IsEmpty(ActiveSheet.Cells(k, j).Value) = False And ActiveSheet.Cells(k, j).Value <> ".." Then
                            If signecond2 = "<" Then
                                If CDbl(ActiveSheet.Cells(k, j).Value) < nbrcond2 = True Then
                                    ActiveSheet.Cells(k, j).Interior.ColorIndex = 22
                                End If
                            ElseIf signecond2 = ">" Then
                                If CDbl(ActiveSheet.Cells(k, j).Value) > nbrcond2 = True Then
                                    ActiveSheet.Cells(k, j).Interior.ColorIndex = 22
                                End If
                            End If
                        End If
                    Next
                End If
            End If
        Next
    Next
    
    

'Faire en sorte que le triggers check aussi le reste des cellules fusionn√©es

End Sub
